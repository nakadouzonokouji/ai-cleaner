const fs = require('fs');
const path = require('path');
require('dotenv').config({ path: path.join(__dirname, '..', '.env') });
const { collectAllProductsComplete, searchWithSDK } = require('./collect-all-products-sdk');

// å ´æ‰€å®šç¾©
const LOCATIONS = {
    kitchen: {
        name: 'ã‚­ãƒƒãƒãƒ³',
        areas: {
            'gas': 'ã‚¬ã‚¹ã‚³ãƒ³ãƒ­',
            'ih': 'IHã‚¯ãƒƒã‚­ãƒ³ã‚°ãƒ’ãƒ¼ã‚¿ãƒ¼',
            'sink': 'ã‚·ãƒ³ã‚¯',
            'ventilation': 'æ›æ°—æ‰‡'
        }
    },
    bathroom: {
        name: 'ãƒã‚¹ãƒ«ãƒ¼ãƒ ',
        areas: {
            'bathtub': 'æµ´æ§½',
            'drain': 'æ’æ°´å£',
            'shower': 'ã‚·ãƒ£ãƒ¯ãƒ¼',
            'toilet': 'ãƒˆã‚¤ãƒ¬',
            'washstand': 'æ´—é¢å°',
            'ventilation': 'æ›æ°—æ‰‡'
        }
    },
    living: {
        name: 'ãƒªãƒ“ãƒ³ã‚°',
        areas: {
            'sofa': 'ã‚½ãƒ•ã‚¡',
            'carpet': 'ã‚«ãƒ¼ãƒšãƒƒãƒˆ',
            'table': 'ãƒ†ãƒ¼ãƒ–ãƒ«',
            'wall': 'å£'
        }
    },
    floor: {
        name: 'åºŠ',
        areas: {
            'flooring': 'ãƒ•ãƒ­ãƒ¼ãƒªãƒ³ã‚°',
            'tatami': 'ç•³',
            'carpet': 'ã‚«ãƒ¼ãƒšãƒƒãƒˆ',
            'tile': 'ã‚¿ã‚¤ãƒ«'
        }
    },
    toilet: {
        name: 'ãƒˆã‚¤ãƒ¬',
        areas: {
            'toilet': 'ä¾¿å™¨',
            'floor': 'åºŠ'
        }
    },
    window: {
        name: 'çª“',
        areas: {
            'glass': 'ã‚¬ãƒ©ã‚¹',
            'sash': 'ã‚µãƒƒã‚·'
        }
    }
};

// æ¤œç´¢ã‚¯ã‚¨ãƒªç”Ÿæˆ
function generateSearchQueries(location, area, level) {
    const searchTerms = {
        kitchen: {
            gas: {
                light: ['ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ã‚¦ã‚¿ãƒãƒ­ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é‡æ›¹', 'ã‚­ãƒ¥ã‚­ãƒ¥ãƒƒãƒˆ', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ã‚¹ãƒ—ãƒ¬ãƒ¼', 'ã‚­ãƒƒãƒãƒ³ã‚¹ãƒãƒ³ã‚¸', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ãƒ¡ãƒ©ãƒŸãƒ³ã‚¹ãƒãƒ³ã‚¸', 'ãƒ“ãƒ‹ãƒ¼ãƒ«æ‰‹è¢‹', 'ã‚¨ãƒ—ãƒ­ãƒ³'],
                heavy: ['æ²¹æ±šã‚Œãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ãƒ¬ãƒ³ã‚¸ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'é‡æ›¹ãƒšãƒ¼ã‚¹ãƒˆ', 'å¼·åŠ›æ´—å‰¤', 'é‡‘å±ãŸã‚ã—', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'ã‚´ãƒ æ‰‹è¢‹ åšæ‰‹', 'ä¿è­·ãƒ¡ã‚¬ãƒ']
            },
            ih: {
                light: ['ã‚¦ã‚¿ãƒãƒ­ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³ ã‚­ãƒƒãƒãƒ³', 'é‡æ›¹ æƒé™¤', 'ã‚»ã‚¹ã‚­ç‚­é…¸ã‚½ãƒ¼ãƒ€', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«é™¤èŒ', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼ã‚¯ãƒ­ã‚¹', 'ã‚­ãƒƒãƒãƒ³ãƒšãƒ¼ãƒ‘ãƒ¼', 'ãƒ¡ãƒ©ãƒŸãƒ³ã‚¹ãƒãƒ³ã‚¸', 'ã‚´ãƒ æ‰‹è¢‹ è–„æ‰‹', 'ä½¿ã„æ¨ã¦æ‰‹è¢‹'],
                heavy: ['IHã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'å¼·åŠ›ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ã‚­ãƒƒãƒãƒ³ãƒã‚¤ã‚¿ãƒ¼', 'ç„¦ã’è½ã¨ã— å°‚ç”¨', 'IHã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹ãŸã‚ã—', 'ç ”ç£¨ãƒ‘ãƒƒãƒ‰', 'ã‚´ãƒ æ‰‹è¢‹ åšæ‰‹', 'ãƒã‚¹ã‚¯']
            },
            sink: {
                light: ['ã‚­ãƒ¥ã‚­ãƒ¥ãƒƒãƒˆ', 'ã‚¸ãƒ§ã‚¤', 'é‡æ›¹', 'ã‚¯ã‚¨ãƒ³é…¸', 'ãƒã‚¤ã‚¿ãƒ¼', 'ã‚¹ãƒãƒ³ã‚¸', 'ãƒ–ãƒ©ã‚·', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ã‚´ãƒ æ‰‹è¢‹', 'ãƒ“ãƒ‹ãƒ¼ãƒ«æ‰‹è¢‹'],
                heavy: ['ãƒ‘ã‚¤ãƒ—ãƒ¦ãƒ‹ãƒƒã‚·ãƒ¥', 'ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'ã‚­ãƒƒãƒãƒ³ãƒã‚¤ã‚¿ãƒ¼', 'æ’æ°´å£æ´—æµ„å‰¤', 'ã‚¯ãƒ¬ãƒ³ã‚¶ãƒ¼', 'æ’æ°´å£ãƒ–ãƒ©ã‚·', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'ãƒ‘ã‚¤ãƒ—ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚´ãƒ æ‰‹è¢‹ ãƒ­ãƒ³ã‚°', 'ãƒã‚¹ã‚¯']
            },
            ventilation: {
                light: ['ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ã‚»ã‚¹ã‚­ç‚­é…¸ã‚½ãƒ¼ãƒ€', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'ä¸­æ€§æ´—å‰¤', 'ã‚¦ã‚¿ãƒãƒ­', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ãƒ–ãƒ©ã‚·', 'æƒé™¤æ©Ÿ', 'ã‚´ãƒ æ‰‹è¢‹', 'ãƒã‚¹ã‚¯'],
                heavy: ['æ›æ°—æ‰‡ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'é‡æ›¹ãƒšãƒ¼ã‚¹ãƒˆ', 'å¼·åŠ›æ´—å‰¤', 'ã‚¢ãƒ«ã‚«ãƒªæ´—å‰¤', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'é«˜åœ§æ´—æµ„', 'ã‚´ãƒ¼ã‚°ãƒ«', 'é˜²è­·æœ']
            }
        },
        bathroom: {
            bathtub: {
                light: ['ãƒã‚¹ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ã‚¦ã‚¿ãƒãƒ­ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é‡æ›¹', 'ã‚¯ã‚¨ãƒ³é…¸', 'ä¸­æ€§æ´—å‰¤', 'ã‚¹ãƒãƒ³ã‚¸', 'ãƒ–ãƒ©ã‚·', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ã‚´ãƒ æ‰‹è¢‹', 'ãƒã‚¹ã‚¹ãƒªãƒƒãƒ‘'],
                heavy: ['ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'ãƒã‚¹ãƒã‚¤ã‚¿ãƒ¼', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'å¼·åŠ›ã‚«ãƒ“å–ã‚Š', 'é¢¨å‘‚é‡œæ´—æµ„å‰¤', 'ã‚«ãƒ“å–ã‚Šãƒ–ãƒ©ã‚·', 'ãƒ‡ãƒƒã‚­ãƒ–ãƒ©ã‚·', 'ã‚¹ãƒãƒ¼ãƒ ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚´ãƒ æ‰‹è¢‹ ãƒ­ãƒ³ã‚°', 'é˜²è­·ãƒã‚¹ã‚¯']
            },
            drain: {
                light: ['ãƒ‘ã‚¤ãƒ—ãƒ¦ãƒ‹ãƒƒã‚·ãƒ¥', 'é‡æ›¹ ã‚¯ã‚¨ãƒ³é…¸', 'ãƒã‚¹ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'æ’æ°´å£ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚«ãƒ“äºˆé˜²å‰¤', 'æ’æ°´å£ãƒ–ãƒ©ã‚·', 'ã‚´ãƒ ãƒ™ãƒ©', 'æ­¯ãƒ–ãƒ©ã‚·', 'ã‚´ãƒ æ‰‹è¢‹', 'ãƒã‚¹ã‚¯'],
                heavy: ['ãƒ‘ã‚¤ãƒ—ãƒã‚¤ã‚¿ãƒ¼', 'ãƒ”ãƒ¼ãƒ”ãƒ¼ã‚¹ãƒ«ãƒ¼', 'æ¥­å‹™ç”¨ãƒ‘ã‚¤ãƒ—ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é«˜æ¿ƒåº¦æ´—å‰¤', 'ã‚«ãƒ“ãƒã‚¤ã‚¿ãƒ¼', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'ãƒ‘ã‚¤ãƒ—ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é«˜åœ§æ´—æµ„', 'ã‚´ãƒ æ‰‹è¢‹ ãƒ­ãƒ³ã‚°', 'é˜²æ¯’ãƒã‚¹ã‚¯']
            },
            shower: {
                light: ['ãƒã‚¹ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ã‚¯ã‚¨ãƒ³é…¸', 'ä¸­æ€§æ´—å‰¤', 'ã‚·ãƒ£ãƒ¯ãƒ¼ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é™¤èŒã‚¹ãƒ—ãƒ¬ãƒ¼', 'ã‚¹ãƒãƒ³ã‚¸', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ã‚¹ã‚¯ã‚¤ãƒ¼ã‚¸ãƒ¼', 'ãƒ“ãƒ‹ãƒ¼ãƒ«æ‰‹è¢‹', 'ãƒã‚¹ã‚¯'],
                heavy: ['ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'æ°´å¢ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'å¼·åŠ›æ´—å‰¤', 'ã‚«ãƒ«ã‚­é™¤å»å‰¤', 'æ¥­å‹™ç”¨ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ãƒ–ãƒ©ã‚·', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ç ”ç£¨ã‚¹ãƒãƒ³ã‚¸', 'ã‚´ãƒ æ‰‹è¢‹', 'ä¿è­·ãƒ¡ã‚¬ãƒ']
            },
            toilet: {
                light: ['ãƒˆã‚¤ãƒ¬ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ãƒˆã‚¤ãƒ¬ã‚¯ã‚¤ãƒƒã‚¯ãƒ«', 'ä¸­æ€§æ´—å‰¤', 'é™¤èŒã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚¯ã‚¨ãƒ³é…¸', 'ãƒˆã‚¤ãƒ¬ãƒ–ãƒ©ã‚·', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ã‚¦ã‚§ãƒƒãƒˆã‚·ãƒ¼ãƒˆ', 'ãƒ“ãƒ‹ãƒ¼ãƒ«æ‰‹è¢‹', 'ä½¿ã„æ¨ã¦æ‰‹è¢‹'],
                heavy: ['ãƒˆã‚¤ãƒ¬ãƒã‚¤ã‚¿ãƒ¼', 'ã‚µãƒ³ãƒãƒ¼ãƒ«', 'å°¿çŸ³é™¤å»å‰¤', 'å¼·åŠ›ãƒˆã‚¤ãƒ¬ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'ãƒˆã‚¤ãƒ¬ãƒ–ãƒ©ã‚·', 'ãƒ‘ã‚¤ãƒ—ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ç ”ç£¨å‰¤', 'ã‚´ãƒ æ‰‹è¢‹ ãƒ­ãƒ³ã‚°', 'ãƒã‚¹ã‚¯']
            },
            washstand: {
                light: ['ãƒã‚¹ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ã‚¯ã‚¨ãƒ³é…¸', 'ä¸­æ€§æ´—å‰¤', 'ã‚¬ãƒ©ã‚¹ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é™¤èŒã‚¹ãƒ—ãƒ¬ãƒ¼', 'ã‚¹ãƒãƒ³ã‚¸', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'æ­¯ãƒ–ãƒ©ã‚·', 'ãƒ“ãƒ‹ãƒ¼ãƒ«æ‰‹è¢‹', 'ãƒã‚¹ã‚¯'],
                heavy: ['ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'æ°´å¢ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ãƒ‘ã‚¤ãƒ—ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'å¼·åŠ›æ´—å‰¤', 'ç ”ç£¨å‰¤', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ãƒ‘ã‚¤ãƒ—ãƒ–ãƒ©ã‚·', 'ã‚´ãƒ æ‰‹è¢‹', 'ä¿è­·ãƒ¡ã‚¬ãƒ']
            },
            ventilation: {
                light: ['ä¸­æ€§æ´—å‰¤', 'ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'ãƒ›ã‚³ãƒªå–ã‚Š', 'é™¤èŒã‚¹ãƒ—ãƒ¬ãƒ¼', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ãƒ–ãƒ©ã‚·', 'æƒé™¤æ©Ÿ', 'ãƒã‚¹ã‚¯', 'æ‰‹è¢‹'],
                heavy: ['æ›æ°—æ‰‡ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'å¼·åŠ›æ´—å‰¤', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'æ¥­å‹™ç”¨æ´—å‰¤', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'é«˜åœ§æ´—æµ„', 'ã‚´ãƒ¼ã‚°ãƒ«', 'é˜²è­·æœ']
            }
        },
        living: {
            sofa: {
                light: ['ãƒ•ã‚¡ãƒ–ãƒªãƒ¼ã‚º', 'é‡æ›¹', 'ä¸­æ€§æ´—å‰¤', 'ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'æ¶ˆè‡­ã‚¹ãƒ—ãƒ¬ãƒ¼', 'ãƒ–ãƒ©ã‚·', 'ã‚³ãƒ­ã‚³ãƒ­', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'æƒé™¤æ©Ÿ', 'æ‰‹è¢‹'],
                heavy: ['ã‚½ãƒ•ã‚¡ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'ã‚·ãƒŸå–ã‚Šå‰¤', 'å¼·åŠ›æ´—å‰¤', 'ã‚¹ãƒãƒ¼ãƒ ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ãƒ–ãƒ©ã‚·', 'ã‚¹ãƒãƒ³ã‚¸', 'ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°æ¶²', 'ã‚´ãƒ æ‰‹è¢‹', 'ãƒã‚¹ã‚¯']
            },
            carpet: {
                light: ['ã‚«ãƒ¼ãƒšãƒƒãƒˆã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é‡æ›¹', 'ä¸­æ€§æ´—å‰¤', 'æ¶ˆè‡­å‰¤', 'ãƒ•ã‚¡ãƒ–ãƒªãƒ¼ã‚º', 'ã‚³ãƒ­ã‚³ãƒ­', 'ãƒ–ãƒ©ã‚·', 'æƒé™¤æ©Ÿ', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'æ‰‹è¢‹'],
                heavy: ['ã‚«ãƒ¼ãƒšãƒƒãƒˆæ´—å‰¤', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'ã‚·ãƒŸæŠœã', 'å¼·åŠ›ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚¹ãƒãƒ¼ãƒ ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ãƒ–ãƒ©ã‚·', 'ã‚¹ãƒãƒ³ã‚¸', 'é«˜åœ§æ´—æµ„', 'ã‚´ãƒ æ‰‹è¢‹', 'ãƒã‚¹ã‚¯']
            },
            table: {
                light: ['ä¸­æ€§æ´—å‰¤', 'ã‚¬ãƒ©ã‚¹ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'ã‚¦ã‚¿ãƒãƒ­', 'ãƒ¯ãƒƒã‚¯ã‚¹', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ã‚¹ãƒãƒ³ã‚¸', 'ãƒ€ã‚¹ã‚¿ãƒ¼', 'æ‰‹è¢‹', 'ã‚¨ãƒ—ãƒ­ãƒ³'],
                heavy: ['å¼·åŠ›æ´—å‰¤', 'ç ”ç£¨å‰¤', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'ã‚¯ãƒ¬ãƒ³ã‚¶ãƒ¼', 'ãƒ¯ãƒƒã‚¯ã‚¹ãƒªãƒ ãƒ¼ãƒãƒ¼', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ç ”ç£¨ã‚¹ãƒãƒ³ã‚¸', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'ã‚´ãƒ æ‰‹è¢‹', 'ãƒã‚¹ã‚¯']
            },
            wall: {
                light: ['ä¸­æ€§æ´—å‰¤', 'ã‚¦ã‚¿ãƒãƒ­', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'é‡æ›¹æ°´', 'ã‚»ã‚¹ã‚­æ°´', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ã‚¹ãƒãƒ³ã‚¸', 'ãƒ¢ãƒƒãƒ—', 'æ‰‹è¢‹', 'ãƒã‚¹ã‚¯'],
                heavy: ['å£ç´™ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'å¼·åŠ›æ´—å‰¤', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'æ¼‚ç™½å‰¤', 'ãƒ–ãƒ©ã‚·', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ã‚¹ãƒãƒ¼ãƒ ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚´ãƒ æ‰‹è¢‹', 'ä¿è­·ãƒ¡ã‚¬ãƒ']
            }
        },
        floor: {
            flooring: {
                light: ['ãƒ•ãƒ­ãƒ¼ãƒªãƒ³ã‚°ãƒ¯ã‚¤ãƒ‘ãƒ¼', 'ä¸­æ€§æ´—å‰¤', 'ãƒ¯ãƒƒã‚¯ã‚¹', 'ã‚¯ã‚¤ãƒƒã‚¯ãƒ«ãƒ¯ã‚¤ãƒ‘ãƒ¼', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'ãƒ¢ãƒƒãƒ—', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'é›‘å·¾', 'æ‰‹è¢‹', 'ã‚¹ãƒªãƒƒãƒ‘'],
                heavy: ['ãƒ•ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ãƒ¯ãƒƒã‚¯ã‚¹ãƒªãƒ ãƒ¼ãƒãƒ¼', 'å¼·åŠ›æ´—å‰¤', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'ç ”ç£¨å‰¤', 'ãƒ–ãƒ©ã‚·', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ãƒãƒªãƒƒã‚·ãƒ£ãƒ¼', 'ã‚´ãƒ æ‰‹è¢‹', 'ãƒã‚¹ã‚¯']
            },
            tatami: {
                light: ['ç•³ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'é‡æ›¹', 'ã‚¯ã‚¨ãƒ³é…¸', 'æ¶ˆè‡­å‰¤', 'ã»ã†ã', 'ã¡ã‚Šã¨ã‚Š', 'æƒé™¤æ©Ÿ', 'é›‘å·¾', 'ãƒã‚¹ã‚¯'],
                heavy: ['ç•³ç”¨æ´—å‰¤', 'ã‚«ãƒ“å–ã‚Šå‰¤', 'é˜²è™«å‰¤', 'å¼·åŠ›ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é™¤èŒå‰¤', 'ãƒ–ãƒ©ã‚·', 'ã‚¹ãƒãƒ¼ãƒ ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ä¹¾ç‡¥æ©Ÿ', 'ã‚´ãƒ æ‰‹è¢‹', 'é˜²è­·ãƒã‚¹ã‚¯']
            },
            carpet: {
                light: ['ã‚«ãƒ¼ãƒšãƒƒãƒˆã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é‡æ›¹', 'ãƒ•ã‚¡ãƒ–ãƒªãƒ¼ã‚º', 'æ¶ˆè‡­ã‚¹ãƒ—ãƒ¬ãƒ¼', 'ä¸­æ€§æ´—å‰¤', 'ã‚³ãƒ­ã‚³ãƒ­', 'ãƒ–ãƒ©ã‚·', 'æƒé™¤æ©Ÿ', 'æ‰‹è¢‹', 'ãƒã‚¹ã‚¯'],
                heavy: ['ã‚«ãƒ¼ãƒšãƒƒãƒˆæ´—å‰¤', 'ã‚·ãƒŸæŠœãå‰¤', 'ã‚ªã‚­ã‚·ã‚¯ãƒªãƒ¼ãƒ³', 'å¼·åŠ›æ´—å‰¤', 'ã‚¹ãƒãƒ¼ãƒ ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ãƒ–ãƒ©ã‚·', 'é«˜åœ§æ´—æµ„', 'ã‚«ãƒ¼ãƒšãƒƒãƒˆã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚´ãƒ æ‰‹è¢‹', 'é˜²è­·æœ']
            },
            tile: {
                light: ['ã‚¿ã‚¤ãƒ«ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ä¸­æ€§æ´—å‰¤', 'ã‚¯ã‚¨ãƒ³é…¸', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'ç›®åœ°ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ãƒ¢ãƒƒãƒ—', 'ã‚¹ãƒãƒ³ã‚¸', 'ãƒ–ãƒ©ã‚·', 'æ‰‹è¢‹', 'ãƒã‚¹ã‚¯'],
                heavy: ['ã‚¿ã‚¤ãƒ«ç”¨æ´—å‰¤', 'ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'å¼·åŠ›æ´—å‰¤', 'ç ”ç£¨å‰¤', 'ç›®åœ°ãƒ–ãƒ©ã‚·', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'é«˜åœ§æ´—æµ„', 'ã‚´ãƒ æ‰‹è¢‹', 'ä¿è­·ãƒ¡ã‚¬ãƒ']
            }
        },
        toilet: {
            toilet: {
                light: ['ãƒˆã‚¤ãƒ¬ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³', 'ãƒˆã‚¤ãƒ¬ã‚¯ã‚¤ãƒƒã‚¯ãƒ«', 'ä¸­æ€§æ´—å‰¤', 'é™¤èŒã‚·ãƒ¼ãƒˆ', 'ã‚¯ã‚¨ãƒ³é…¸', 'ãƒˆã‚¤ãƒ¬ãƒ–ãƒ©ã‚·', 'ã‚¹ãƒãƒ³ã‚¸', 'ã‚¦ã‚§ãƒƒãƒˆãƒ†ã‚£ãƒƒã‚·ãƒ¥', 'æ‰‹è¢‹', 'ãƒã‚¹ã‚¯'],
                heavy: ['ã‚µãƒ³ãƒãƒ¼ãƒ«', 'ãƒˆã‚¤ãƒ¬ãƒã‚¤ã‚¿ãƒ¼', 'å°¿çŸ³é™¤å»å‰¤', 'å¼·åŠ›æ´—å‰¤', 'ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'ãƒ–ãƒ©ã‚·', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ãƒ‘ã‚¤ãƒ—ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚´ãƒ æ‰‹è¢‹', 'é˜²è­·ãƒã‚¹ã‚¯']
            },
            floor: {
                light: ['ãƒˆã‚¤ãƒ¬ã‚¯ã‚¤ãƒƒã‚¯ãƒ«', 'ä¸­æ€§æ´—å‰¤', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'é™¤èŒã‚¹ãƒ—ãƒ¬ãƒ¼', 'ã‚¯ã‚¨ãƒ³é…¸', 'ãƒ¢ãƒƒãƒ—', 'ã‚¦ã‚§ãƒƒãƒˆã‚·ãƒ¼ãƒˆ', 'é›‘å·¾', 'æ‰‹è¢‹', 'ã‚¹ãƒªãƒƒãƒ‘'],
                heavy: ['ãƒˆã‚¤ãƒ¬ç”¨æ´—å‰¤', 'ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'å¼·åŠ›æ´—å‰¤', 'æ¼‚ç™½å‰¤', 'é™¤èŒå‰¤', 'ãƒ–ãƒ©ã‚·', 'ãƒ‡ãƒƒã‚­ãƒ–ãƒ©ã‚·', 'ã‚¹ãƒãƒ¼ãƒ ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚´ãƒ æ‰‹è¢‹', 'ãƒã‚¹ã‚¯']
            }
        },
        window: {
            glass: {
                light: ['ã‚¬ãƒ©ã‚¹ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ä¸­æ€§æ´—å‰¤', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'ãƒã‚¤ãƒšãƒƒãƒˆ', 'æ°´', 'ã‚¹ã‚¯ã‚¤ãƒ¼ã‚¸ãƒ¼', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'æ–°èç´™', 'æ‰‹è¢‹', 'ãƒã‚±ãƒ„'],
                heavy: ['ã‚¬ãƒ©ã‚¹ç”¨æ´—å‰¤', 'å¼·åŠ›ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ç ”ç£¨å‰¤', 'ã‚¹ã‚±ãƒ¼ãƒ«é™¤å»å‰¤', 'ã‚«ãƒ“å–ã‚Šå‰¤', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'é«˜åœ§æ´—æµ„', 'ã‚´ãƒ æ‰‹è¢‹', 'ä¿è­·ãƒ¡ã‚¬ãƒ']
            },
            sash: {
                light: ['ä¸­æ€§æ´—å‰¤', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«', 'ãƒ–ãƒ©ã‚·', 'æ­¯ãƒ–ãƒ©ã‚·', 'ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'é›‘å·¾', 'ãƒã‚¤ã‚¯ãƒ­ãƒ•ã‚¡ã‚¤ãƒãƒ¼', 'ç¶¿æ£’', 'æ‰‹è¢‹', 'ãƒã‚¹ã‚¯'],
                heavy: ['ã‚µãƒƒã‚·ã‚¯ãƒªãƒ¼ãƒŠãƒ¼', 'ã‚«ãƒ“ã‚­ãƒ©ãƒ¼', 'å¼·åŠ›æ´—å‰¤', 'ç ”ç£¨å‰¤', 'é‡‘å±ç£¨ã', 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ–ãƒ©ã‚·', 'ã‚¹ã‚¯ãƒ¬ãƒ¼ãƒ‘ãƒ¼', 'é«˜åœ§æ´—æµ„', 'ã‚´ãƒ æ‰‹è¢‹', 'é˜²è­·æœ']
            }
        }
    };

    const key = searchTerms[location]?.[area]?.[level];
    if (!key) {
        console.warn(`âš ï¸ æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${location}/${area}/${level}`);
        return [];
    }
    
    return key;
}

// é€²æ—è¿½è·¡
class ProgressTracker {
    constructor(total) {
        this.total = total;
        this.current = 0;
        this.startTime = Date.now();
        this.errors = [];
    }

    increment() {
        this.current++;
        const elapsed = Date.now() - this.startTime;
        const rate = this.current / (elapsed / 1000);
        const remaining = (this.total - this.current) / rate;
        
        const elapsedStr = this.formatTime(elapsed / 1000);
        const remainingStr = this.formatTime(remaining);
        const percentage = ((this.current / this.total) * 100).toFixed(1);
        
        process.stdout.write(`\r[${this.current}/${this.total}] ${percentage}% å®Œäº† | çµŒé: ${elapsedStr} | æ®‹ã‚Š: ${remainingStr}`);
    }

    formatTime(seconds) {
        const hours = Math.floor(seconds / 3600);
        const minutes = Math.floor((seconds % 3600) / 60);
        const secs = Math.floor(seconds % 60);
        return `${hours}h ${minutes}m ${secs}s`;
    }

    addError(error) {
        this.errors.push(error);
    }

    getStats() {
        const elapsed = (Date.now() - this.startTime) / 1000;
        const rate = this.current / elapsed;
        return {
            total: this.total,
            completed: this.current,
            errors: this.errors.length,
            elapsed: this.formatTime(elapsed),
            rate: `${rate.toFixed(2)} items/sec`
        };
    }
}

// ã‚«ãƒ†ã‚´ãƒªåˆ¥å•†å“åé›†
async function collectCategoryProducts(location, area, level, queries, tracker) {
    const products = [];
    const id = `${location}-${area}-${level}`;
    
    console.log(`\nğŸ“¦ ${id} ã®å•†å“ã‚’åé›†ä¸­...`);
    
    for (const query of queries) {
        try {
            const searchResults = await searchWithSDK(query, 10);
            console.log(`  âœ… ${query}: ${searchResults.length}å•†å“`);
            
            searchResults.forEach(item => {
                products.push({
                    id: `${id}-${item.id}`,
                    asin: item.id,
                    title: item.name || 'ã‚¿ã‚¤ãƒˆãƒ«ä¸æ˜',
                    price: item.price || 0,
                    priceDisplay: `ï¿¥${item.price?.toLocaleString() || 'ä¾¡æ ¼ä¸æ˜'}`,
                    image: item.image || '',
                    link: item.url || '',
                    location: location,
                    area: area,
                    level: level,
                    searchQuery: query,
                    collectedAt: new Date().toISOString()
                });
            });
            
            tracker.increment();
            
            // ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–ï¼ˆå°‘ã—é•·ã‚ã®å¾…æ©Ÿæ™‚é–“ï¼‰
            await new Promise(resolve => setTimeout(resolve, 1200));
            
        } catch (error) {
            console.error(`  âŒ ${query}: ã‚¨ãƒ©ãƒ¼ - ${error.message}`);
            tracker.addError({
                query,
                location,
                area,
                level,
                error: error.message,
                timestamp: new Date().toISOString()
            });
            tracker.increment();
        }
    }
    
    return products;
}

// ç‰¹å®šã®å ´æ‰€ã®å…¨å•†å“ã‚’åé›†
async function collectLocationProducts(locationKey) {
    const location = LOCATIONS[locationKey];
    if (!location) {
        console.error(`âŒ ç„¡åŠ¹ãªå ´æ‰€: ${locationKey}`);
        return;
    }

    console.log(`\nğŸ  === ${location.name} (${locationKey}) ã®å•†å“åé›†é–‹å§‹ ===\n`);
    
    // ã“ã®å ´æ‰€ã®ç·æ¤œç´¢æ•°ã‚’è¨ˆç®—
    let totalSearches = 0;
    Object.keys(location.areas).forEach(area => {
        totalSearches += 20; // light(10) + heavy(10)
    });
    
    const tracker = new ProgressTracker(totalSearches);
    const allProducts = [];
    
    // å„ã‚¨ãƒªã‚¢ã‚’é †ç•ªã«å‡¦ç†
    for (const [areaKey, areaName] of Object.entries(location.areas)) {
        console.log(`\nğŸ“ ${areaName} (${areaKey})`);
        
        // è»½ã„æ±šã‚Œç”¨ã¨é ‘å›ºãªæ±šã‚Œç”¨
        for (const level of ['light', 'heavy']) {
            const queries = generateSearchQueries(locationKey, areaKey, level);
            if (queries.length > 0) {
                const products = await collectCategoryProducts(locationKey, areaKey, level, queries, tracker);
                allProducts.push(...products);
            }
        }
    }
    
    // å ´æ‰€åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
    const outputDir = path.join(__dirname, '..', 'products-by-location');
    if (!fs.existsSync(outputDir)) {
        fs.mkdirSync(outputDir);
    }
    
    const outputFile = path.join(outputDir, `${locationKey}-products.json`);
    const locationData = {
        location: locationKey,
        locationName: location.name,
        totalProducts: allProducts.length,
        collectedAt: new Date().toISOString(),
        products: allProducts
    };
    
    fs.writeFileSync(outputFile, JSON.stringify(locationData, null, 2));
    
    // çµ±è¨ˆè¡¨ç¤º
    const stats = tracker.getStats();
    console.log(`\n\nğŸ“Š === ${location.name} åé›†å®Œäº† ===`);
    console.log(`âœ… ç·å•†å“æ•°: ${allProducts.length}`);
    console.log(`â±ï¸  å‡¦ç†æ™‚é–“: ${stats.elapsed}`);
    console.log(`ğŸš€ å‡¦ç†é€Ÿåº¦: ${stats.rate}`);
    console.log(`âŒ ã‚¨ãƒ©ãƒ¼æ•°: ${stats.errors}`);
    console.log(`ğŸ’¾ ä¿å­˜å…ˆ: ${outputFile}`);
    
    return allProducts;
}

// ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ
if (require.main === module) {
    const args = process.argv.slice(2);
    const locationKey = args[0];
    
    if (!locationKey || !LOCATIONS[locationKey]) {
        console.log('ä½¿ç”¨æ–¹æ³•:');
        console.log('  node collect-products-by-location.js <location>');
        console.log('\nåˆ©ç”¨å¯èƒ½ãªå ´æ‰€:');
        Object.entries(LOCATIONS).forEach(([key, value]) => {
            console.log(`  ${key} - ${value.name}`);
        });
        process.exit(1);
    }
    
    collectLocationProducts(locationKey).catch(console.error);
}

module.exports = { collectLocationProducts };