<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amazon商品画像URLテスト</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .product-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .product-image {
            width: 100%;
            height: 200px;
            object-fit: contain;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .product-info {
            font-size: 14px;
            margin-bottom: 10px;
        }
        .url-info {
            font-size: 12px;
            color: #666;
            word-break: break-all;
            margin-top: 10px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        h1 {
            color: #333;
        }
        .test-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Amazon商品画像URLパターンテスト</h1>
        
        <div class="test-info">
            <h3>テスト対象ASIN</h3>
            <ul>
                <li>B07C44DM6S - 花王 マジックリン ハンディスプレー</li>
                <li>B0012R4V2S - カビキラー</li>
            </ul>
            <p>各商品に対して、複数のURLパターンをテストして実際に画像が表示されるか確認します。</p>
        </div>

        <div class="product-grid" id="productGrid"></div>
    </div>

    <script>
        // テスト対象の商品
        const testProducts = [
            {
                asin: 'B07C44DM6S',
                name: '花王 マジックリン ハンディスプレー',
                testImageIds: ['41vX3QHG5LL', '51vX3QHG5LL', '61vX3QHG5LL', '71vX3QHG5LL']
            },
            {
                asin: 'B0012R4V2S',
                name: 'カビキラー',
                testImageIds: ['51xQx5W3veL', '41xQx5W3veL', '61xQx5W3veL', '71xQx5W3veL']
            }
        ];

        // 各種URLパターン
        const urlPatterns = [
            {
                name: 'メイン画像URL (m.media-amazon.com)',
                generator: (imageId) => `https://m.media-amazon.com/images/I/${imageId}._AC_SL500_.jpg`
            },
            {
                name: '旧形式URL (images-na)',
                generator: (asin) => `https://images-na.ssl-images-amazon.com/images/P/${asin}.01._SCLZZZZZZZ_.jpg`
            },
            {
                name: 'ウィジェットAPI',
                generator: (asin) => `https://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=${asin}&Format=_SL160_&ID=AsinImage`
            },
            {
                name: 'ecx.images-amazon.com',
                generator: (asin) => `https://ecx.images-amazon.com/images/I/${asin}._SL500_.jpg`
            },
            {
                name: 'images-jp.amazon.com',
                generator: (asin) => `https://images-jp.amazon.com/images/P/${asin}.09.LZZZZZZZ.jpg`
            }
        ];

        function createProductCard(product, pattern, urlParam) {
            const url = pattern.generator(urlParam);
            const card = document.createElement('div');
            card.className = 'product-card';
            
            const img = document.createElement('img');
            img.className = 'product-image';
            img.src = url;
            img.alt = product.name;
            
            const status = document.createElement('span');
            status.className = 'status';
            
            img.onload = function() {
                status.className = 'status success';
                status.textContent = '✓ 画像読み込み成功';
            };
            
            img.onerror = function() {
                status.className = 'status error';
                status.textContent = '✗ 画像読み込み失敗';
                img.style.display = 'none';
            };
            
            const info = document.createElement('div');
            info.className = 'product-info';
            info.innerHTML = `
                <h3>${product.name}</h3>
                <p>ASIN: ${product.asin}</p>
                <p>パターン: ${pattern.name}</p>
                <p>パラメータ: ${urlParam}</p>
            `;
            
            const urlInfo = document.createElement('div');
            urlInfo.className = 'url-info';
            urlInfo.textContent = url;
            
            card.appendChild(img);
            card.appendChild(status);
            card.appendChild(info);
            card.appendChild(urlInfo);
            
            return card;
        }

        // テスト実行
        const grid = document.getElementById('productGrid');
        
        testProducts.forEach(product => {
            // ASINベースのパターンをテスト
            urlPatterns.slice(1).forEach(pattern => {
                grid.appendChild(createProductCard(product, pattern, product.asin));
            });
            
            // 画像IDベースのパターンをテスト
            product.testImageIds.forEach(imageId => {
                grid.appendChild(createProductCard(product, urlPatterns[0], imageId));
            });
        });
    </script>
</body>
</html>